<!DOCTYPE HTML>
<html lang="en">
<head>
<title>ElGamalAESEngine - Javadocs [I2P+ 0.9.50]</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: net.i2p.router.crypto, class: ElGamalAESEngine">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>

<script type="text/javascript" src="../../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>

<script type="text/javascript" src="../../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":42,"i1":10,"i2":10,"i3":10,"i4":10,"i5":42,"i6":42,"i7":10,"i8":10,"i9":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"],32:["t6","Deprecated Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<style type="text/css">.script{display:none!important}</style>

</noscript>
<div class="flexBox">
<header role="banner" class="flexHeader">
<nav role="navigation">
<div class="topNav"><a id="navbar.top">
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ElGamalAESEngine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch script"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<div class="skipNav"><a id="skip.navbar.top">
</a></div>
</nav>
</header>
<div class="flexContent">
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">net.i2p.router.crypto</a></div>
<h1 title="Class ElGamalAESEngine" class="title">Class ElGamalAESEngine</h1>
</div>
<div class="contentContainer">
<div class="inheritance" title="Inheritance Tree"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a>
<div class="inheritance">net.i2p.router.crypto.ElGamalAESEngine</div>
</div>
<section class="description">
<hr>
<pre>public final class <span class="typeNameLabel">ElGamalAESEngine</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></pre>
<div class="block">Handles the actual ElGamal+AES encryption and decryption scenarios using the
 supplied keys and data.

 No, this does not extend AESEngine or CryptixAESEngine.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.38 moved from net.i2p.crypto</dd>
</dl>
</section>
<section class="summary">
<ul class="blockList">
<li class="blockList">
<section class="fieldSummary"><a id="field.summary">
</a>
<h2>Field Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#MAX_TAGS_RECEIVED">MAX_TAGS_RECEIVED</a></span></code></th>
<td class="colLast">
<div class="block">enforced since release 0.6</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<li class="blockList">
<section class="constructorSummary"><a id="constructor.summary">
</a>
<h2>Constructor Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(net.i2p.I2PAppContext)">ElGamalAESEngine</a></span>&#8203;(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div class="script" role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t6" class="tableTab" onclick="show(32);">Deprecated Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#decrypt(byte%5B%5D,net.i2p.data.PrivateKey)">decrypt</a></span>&#8203;(byte[]&nbsp;data,
<a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">specify the key manager!</div>
</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#decrypt(byte%5B%5D,net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)">decrypt</a></span>&#8203;(byte[]&nbsp;data,
<a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
<a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</code></th>
<td class="colLast">
<div class="block">Decrypt the message using the given private key
 and using tags from the specified key manager.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>(package private) byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#decryptAESBlock(byte%5B%5D,int,int,net.i2p.data.SessionKey,byte%5B%5D,byte%5B%5D,java.util.Set,net.i2p.data.SessionKey)">decryptAESBlock</a></span>&#8203;(byte[]&nbsp;encrypted,
int&nbsp;offset,
int&nbsp;encryptedLen,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
byte[]&nbsp;iv,
byte[]&nbsp;sentTag,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;foundTags,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;foundKey)</code></th>
<td class="colLast">
<div class="block">private byte[] decryptAESBlock(byte encrypted[], SessionKey key, byte iv[],
                           byte sentTag[], Set foundTags, SessionKey foundKey) throws DataFormatException {
        return decryptAESBlock(encrypted, 0, encrypted.length, key, iv, sentTag, foundTags, foundKey);
    }</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#decryptFast(byte%5B%5D,net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)">decryptFast</a></span>&#8203;(byte[]&nbsp;data,
<a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
<a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</code></th>
<td class="colLast">
<div class="block">Tags only.</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#decryptSlow(byte%5B%5D,net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)">decryptSlow</a></span>&#8203;(byte[]&nbsp;data,
<a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
<a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</code></th>
<td class="colLast">
<div class="block">Full ElG only.</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#encrypt(byte%5B%5D,net.i2p.data.PublicKey,net.i2p.data.SessionKey,long)">encrypt</a></span>&#8203;(byte[]&nbsp;data,
<a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
long&nbsp;paddedSize)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">unused</div>
</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#encrypt(byte%5B%5D,net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,long)">encrypt</a></span>&#8203;(byte[]&nbsp;data,
<a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
long&nbsp;paddedSize)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">unused</div>
</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#encrypt(byte%5B%5D,net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,net.i2p.data.SessionTag,long)">encrypt</a></span>&#8203;(byte[]&nbsp;data,
<a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
long&nbsp;paddedSize)</code></th>
<td class="colLast">
<div class="block">Encrypt the data to the target using the given key and deliver the specified tags
 No new session key
 This is the one called from GarlicMessageBuilder and is the primary entry point.</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#encrypt(byte%5B%5D,net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,net.i2p.data.SessionTag,net.i2p.data.SessionKey,long)">encrypt</a></span>&#8203;(byte[]&nbsp;data,
<a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
long&nbsp;paddedSize)</code></th>
<td class="colLast">
<div class="block">Encrypt the unencrypted data to the target.</div>
</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>(package private) byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#encryptAESBlock(byte%5B%5D,net.i2p.data.SessionKey,byte%5B%5D,java.util.Set,net.i2p.data.SessionKey,long)">encryptAESBlock</a></span>&#8203;(byte[]&nbsp;data,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
byte[]&nbsp;iv,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
long&nbsp;paddedSize)</code></th>
<td class="colLast">
<div class="block">For both scenarios, this method encrypts the AES area using the given key, iv
 and making sure the resulting data is at least as long as the paddedSize and
 also mod 16 bytes.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<a id="methods.inherited.from.class.java.lang.Object">
</a><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<li class="blockList">
<section class="fieldDetails"><a id="field.detail">
</a>
<h2>Field Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="MAX_TAGS_RECEIVED">MAX_TAGS_RECEIVED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">MAX_TAGS_RECEIVED</span></div>
<div class="block">enforced since release 0.6</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#net.i2p.router.crypto.ElGamalAESEngine.MAX_TAGS_RECEIVED">Constant Field Values</a></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<li class="blockList">
<section class="constructorDetails"><a id="constructor.detail">
</a>
<h2>Constructor Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(net.i2p.I2PAppContext)">ElGamalAESEngine</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="memberName">ElGamalAESEngine</span>&#8203;(<span class="arguments"><a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx)</span></div>
</section>
</li>
</ul>
</section>
</li>
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="decrypt(byte[],net.i2p.data.PrivateKey)">decrypt</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">byte[]</span>&nbsp;<span class="memberName">decrypt</span>&#8203;(<span class="arguments">byte[]&nbsp;data,
<a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey)</span>
               throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">specify the key manager!</div>
</div>
<div class="block">Decrypt the message using the given private key using tags from the default key manager,
 which is the router's key manager. Use extreme care if you aren't the router.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="decrypt(byte[],net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)">decrypt</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">byte[]</span>&nbsp;<span class="memberName">decrypt</span>&#8203;(<span class="arguments">byte[]&nbsp;data,
<a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
<a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</span>
               throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="block">Decrypt the message using the given private key
 and using tags from the specified key manager.
 This works according to the
 ElGamal+AES algorithm in the data structure spec.

 Warning - use the correct SessionKeyManager. Clients should instantiate their own.
 Clients using I2PAppContext.sessionKeyManager() may be correlated with the router,
 unless you are careful to use different keys.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>decrypted data or null on failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="decryptFast(byte[],net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)">decryptFast</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">byte[]</span>&nbsp;<span class="memberName">decryptFast</span>&#8203;(<span class="arguments">byte[]&nbsp;data,
<a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
<a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</span>
                   throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="block">Tags only. For MuxedEngine use only.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>decrypted data or null on failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.46</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="decryptSlow(byte[],net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)">decryptSlow</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">byte[]</span>&nbsp;<span class="memberName">decryptSlow</span>&#8203;(<span class="arguments">byte[]&nbsp;data,
<a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
<a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</span>
                   throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="block">Full ElG only. For MuxedEngine use only.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>decrypted data or null on failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.46</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="decryptAESBlock(byte[],int,int,net.i2p.data.SessionKey,byte[],byte[],java.util.Set,net.i2p.data.SessionKey)">decryptAESBlock</a></h3>
<div class="memberSignature"><span class="returnType">byte[]</span>&nbsp;<span class="memberName">decryptAESBlock</span>&#8203;(<span class="arguments">byte[]&nbsp;encrypted,
int&nbsp;offset,
int&nbsp;encryptedLen,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
byte[]&nbsp;iv,
byte[]&nbsp;sentTag,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;foundTags,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;foundKey)</span>
                throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="block">private byte[] decryptAESBlock(byte encrypted[], SessionKey key, byte iv[],
                           byte sentTag[], Set foundTags, SessionKey foundKey) throws DataFormatException {
        return decryptAESBlock(encrypted, 0, encrypted.length, key, iv, sentTag, foundTags, foundKey);
    }</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="encrypt(byte[],net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,net.i2p.data.SessionTag,net.i2p.data.SessionKey,long)">encrypt</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">byte[]</span>&nbsp;<span class="memberName">encrypt</span>&#8203;(<span class="arguments">byte[]&nbsp;data,
<a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
long&nbsp;paddedSize)</span></div>
<div class="block">Encrypt the unencrypted data to the target.  The total size returned will be
 no less than the paddedSize parameter, but may be more.  This method uses the
 ElGamal+AES algorithm in the data structure spec.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>target</code> - public key to which the data should be encrypted, must be ELGAMAL_2048.
               May be null if key and currentTag are non-null.</dd>
<dd><code>key</code> - session key to use during encryption</dd>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key (or newKey if specified), or null;
                        200 max enforced at receiver</dd>
<dd><code>currentTag</code> - sessionTag to use, or null if it should use ElG (i.e. new session)</dd>
<dd><code>newKey</code> - key to be delivered to the target, with which the tagsForDelivery should be associated, or null</dd>
<dd><code>paddedSize</code> - minimum size in bytes of the body after padding it (if less than the
          body's real size, no bytes are appended but the body is not truncated)</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalArgumentException</a></code> - on bad target EncType

 Unused externally, only called by below (i.e. newKey is always null)</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="encrypt(byte[],net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,net.i2p.data.SessionTag,long)">encrypt</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">byte[]</span>&nbsp;<span class="memberName">encrypt</span>&#8203;(<span class="arguments">byte[]&nbsp;data,
<a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
long&nbsp;paddedSize)</span></div>
<div class="block">Encrypt the data to the target using the given key and deliver the specified tags
 No new session key
 This is the one called from GarlicMessageBuilder and is the primary entry point.

 Re: padded size: The AES block adds at least 39 bytes of overhead to the data, and
 that is included in the minimum size calculation.

 In the router, we always use garlic messages. A garlic message with a single
 clove and zero data is about 84 bytes, so that's 123 bytes minimum. So any paddingSize
 &lt;= 128 is a no-op as every message will be at least 128 bytes
 (Streaming, if used, adds more overhead).

 Outside the router, with a client using its own message format, the minimum size
 is 48, so any paddingSize &lt;= 48 is a no-op.

 Not included in the minimum is a 32-byte session tag for an existing session,
 or a 514-byte ElGamal block and several 32-byte session tags for a new session.
 So the returned encrypted data will be at least 32 bytes larger than paddedSize.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>target</code> - public key to which the data should be encrypted, must be ELGAMAL_2048.
               May be null if key and currentTag are non-null.</dd>
<dd><code>key</code> - session key to use during encryption</dd>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key or null;
                        200 max enforced at receiver</dd>
<dd><code>currentTag</code> - sessionTag to use, or null if it should use ElG (i.e. new session)</dd>
<dd><code>paddedSize</code> - minimum size in bytes of the body after padding it (if less than the
          body's real size, no bytes are appended but the body is not truncated)</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalArgumentException</a></code> - on bad target EncType</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="encrypt(byte[],net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,long)">encrypt</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">byte[]</span>&nbsp;<span class="memberName">encrypt</span>&#8203;(<span class="arguments">byte[]&nbsp;data,
<a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
long&nbsp;paddedSize)</span></div>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">unused</div>
</div>
<div class="block">Encrypt the data to the target using the given key and deliver the specified tags
 No new session key
 No current tag (encrypt as new session)</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key or null;
                        200 max enforced at receiver</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalArgumentException</a></code> - on bad target EncType</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="encrypt(byte[],net.i2p.data.PublicKey,net.i2p.data.SessionKey,long)">encrypt</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">byte[]</span>&nbsp;<span class="memberName">encrypt</span>&#8203;(<span class="arguments">byte[]&nbsp;data,
<a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
long&nbsp;paddedSize)</span></div>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">unused</div>
</div>
<div class="block">Encrypt the data to the target using the given key delivering no tags
 No new session key
 No current tag (encrypt as new session)</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalArgumentException</a></code> - on bad target EncType</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="encryptAESBlock(byte[],net.i2p.data.SessionKey,byte[],java.util.Set,net.i2p.data.SessionKey,long)">encryptAESBlock</a></h3>
<div class="memberSignature"><span class="modifiers">final</span>&nbsp;<span class="returnType">byte[]</span>&nbsp;<span class="memberName">encryptAESBlock</span>&#8203;(<span class="arguments">byte[]&nbsp;data,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
byte[]&nbsp;iv,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
<a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
long&nbsp;paddedSize)</span></div>
<div class="block">For both scenarios, this method encrypts the AES area using the given key, iv
 and making sure the resulting data is at least as long as the paddedSize and
 also mod 16 bytes.  The contents of the encrypted data is:
 <pre>
  - 2 byte integer specifying the # of session tags
  - that many 32 byte session tags
  - 4 byte integer specifying data.length
  - SHA256 of data
  - 1 byte flag that, if == 1, is followed by a new SessionKey
  - data
  - random bytes, padding the total size to greater than paddedSize with a mod 16 = 0
 </pre>

 Note: package private for ElGamalTest.testAES()</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key or null;
                        200 max enforced at receiver</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
</main>
<footer role="contentinfo">
<nav role="navigation">
<div class="bottomNav"><a id="navbar.bottom">
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ElGamalAESEngine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
</a>
</nav>
</footer>
</div>
</div>
</body>
</html>
