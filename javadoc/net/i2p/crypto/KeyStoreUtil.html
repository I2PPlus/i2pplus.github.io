<!DOCTYPE HTML>
<html lang="en">
<head>
<title>KeyStoreUtil - Javadocs [I2P+ 0.9.50]</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: net.i2p.crypto, class: KeyStoreUtil">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>

<script type="text/javascript" src="../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>

<script type="text/javascript" src="../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9,"i6":9,"i7":9,"i8":9,"i9":9,"i10":9,"i11":9,"i12":9,"i13":9,"i14":9,"i15":9,"i16":9,"i17":9,"i18":9,"i19":9,"i20":9,"i21":9,"i22":9,"i23":9,"i24":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<style type="text/css">.script{display:none!important}</style>

</noscript>
<div class="flexBox">
<header role="banner" class="flexHeader">
<nav role="navigation">
<div class="topNav"><a id="navbar.top">
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/KeyStoreUtil.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch script"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<div class="skipNav"><a id="skip.navbar.top">
</a></div>
</nav>
</header>
<div class="flexContent">
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">net.i2p.crypto</a></div>
<h1 title="Class KeyStoreUtil" class="title">Class KeyStoreUtil</h1>
</div>
<div class="contentContainer">
<div class="inheritance" title="Inheritance Tree"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a>
<div class="inheritance">net.i2p.crypto.KeyStoreUtil</div>
</div>
<section class="description">
<hr>
<pre>public final class <span class="typeNameLabel">KeyStoreUtil</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></pre>
<div class="block">Keystore utilities, consolidated from various places.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.9</dd>
</dl>
</section>
<section class="summary">
<ul class="blockList">
<li class="blockList">
<section class="fieldSummary"><a id="field.summary">
</a>
<h2>Field Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_KEYSTORE_PASSWORD">DEFAULT_KEYSTORE_PASSWORD</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<li class="blockList">
<section class="constructorSummary"><a id="constructor.summary">
</a>
<h2>Constructor Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">KeyStoreUtil</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div class="script" role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t1" class="tableTab" onclick="show(1);">Static Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addCert(java.io.File,java.lang.String,java.security.KeyStore)">addCert</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;file,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks)</code></th>
<td class="colLast">
<div class="block">Load an X509 Cert from a file and add it to the
  trusted set of certificates in the key store

  This does NOT check for revocation.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addCert(java.io.File,java.lang.String,java.security.KeyStore,java.security.cert.CertStore)">addCert</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;file,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/cert/CertStore.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">CertStore</a>&nbsp;cs)</code></th>
<td class="colLast">
<div class="block">Load an X509 Cert from a file and add it to the
  trusted set of certificates in the key store

  This DOES check for revocation, IF cs is non-null.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addCerts(java.io.File,java.security.KeyStore)">addCerts</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;dir,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks)</code></th>
<td class="colLast">
<div class="block">Load all X509 Certs from a directory and add them to the
  trusted set of certificates in the key store

  This DOES check for revocation.</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#countCerts(java.security.KeyStore)">countCerts</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks)</code></th>
<td class="colLast">
<div class="block">Count all X509 Certs in a key store</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createKeys(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.lang.String)">createKeys</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</code></th>
<td class="colLast">
<div class="block">Create a keypair and store it in the keystore at ks, creating it if necessary.</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createKeys(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.lang.String,int,java.lang.String,int,java.lang.String)">createKeys</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyAlg,
int&nbsp;keySize,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</code></th>
<td class="colLast">
<div class="block">Create a keypair and store it in the keystore at ks, creating it if necessary.</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createKeys(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.util.Set,java.lang.String,int,java.lang.String,int,java.lang.String)">createKeys</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;altNames,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyAlg,
int&nbsp;keySize,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</code></th>
<td class="colLast">
<div class="block">Create a keypair and store it in the keystore at ks, creating it if necessary.</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createKeys(java.io.File,java.lang.String,java.lang.String,java.util.Set,java.lang.String,java.lang.String)">createKeys</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;altNames,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</code></th>
<td class="colLast">
<div class="block">Create a keypair and store it in the keystore at ks, creating it if necessary.</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createKeysAndCRL(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.lang.String,int,java.lang.String,int,java.lang.String)">createKeysAndCRL</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyAlg,
int&nbsp;keySize,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</code></th>
<td class="colLast">
<div class="block">New way - Native Java, does not call out to keytool.</div>
</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createKeysAndCRL(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.lang.String,int,net.i2p.crypto.SigType,java.lang.String)">createKeysAndCRL</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="SigType.html" title="enum in net.i2p.crypto">SigType</a>&nbsp;type,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</code></th>
<td class="colLast">
<div class="block">New way - Native Java, does not call out to keytool.</div>
</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createKeysAndCRL(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.util.Set,java.lang.String,int,java.lang.String,int,java.lang.String)">createKeysAndCRL</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;altNames,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyAlg,
int&nbsp;keySize,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</code></th>
<td class="colLast">
<div class="block">New way - Native Java, does not call out to keytool.</div>
</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createKeysAndCRL(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.util.Set,java.lang.String,int,net.i2p.crypto.SigType,java.lang.String)">createKeysAndCRL</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;altNames,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="SigType.html" title="enum in net.i2p.crypto">SigType</a>&nbsp;type,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</code></th>
<td class="colLast">
<div class="block">New way - Native Java, does not call out to keytool.</div>
</td>
</tr>
<tr class="altColor" id="i12">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createKeyStore(java.io.File,java.lang.String)">createKeyStore</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ksFile,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password)</code></th>
<td class="colLast">
<div class="block">Create a new KeyStore object, and load it from ksFile if it is
  non-null and it exists.</div>
</td>
</tr>
<tr class="rowColor" id="i13">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#exportCert(java.io.File,java.lang.String,java.lang.String,java.io.File)">exportCert</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;certFile)</code></th>
<td class="colLast">
<div class="block">Pull the cert back OUT of the keystore and save it in Base64-encoded X.509 format
  so the clients can get to it.</div>
</td>
</tr>
<tr class="altColor" id="i14">
<td class="colFirst"><code>static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#exportPrivateKey(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.io.OutputStream)">exportPrivateKey</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io" class="externalLink">OutputStream</a>&nbsp;out)</code></th>
<td class="colLast">
<div class="block">Export the private key and certificate chain (if any) out of a keystore.</div>
</td>
</tr>
<tr class="rowColor" id="i15">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCert(java.io.File,java.lang.String,java.lang.String)">getCert</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias)</code></th>
<td class="colLast">
<div class="block">Get a cert out of a keystore</div>
</td>
</tr>
<tr class="altColor" id="i16">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/security/PrivateKey.html?is-external=true" title="class or interface in java.security" class="externalLink">PrivateKey</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getPrivateKey(java.io.File,java.lang.String,java.lang.String,java.lang.String)">getPrivateKey</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</code></th>
<td class="colLast">
<div class="block">Get a private key out of a keystore</div>
</td>
</tr>
<tr class="rowColor" id="i17">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#importPrivateKey(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.io.InputStream)">importPrivateKey</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html?is-external=true" title="class or interface in java.io" class="externalLink">InputStream</a>&nbsp;in)</code></th>
<td class="colLast">
<div class="block">Import the private key and certificate chain to a keystore.</div>
</td>
</tr>
<tr class="altColor" id="i18">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#loadSystemKeyStore()">loadSystemKeyStore</a></span>()</code></th>
<td class="colLast">
<div class="block">Loads certs from location of javax.net.ssl.keyStore property,
  else from $JAVA_HOME/lib/security/jssecacerts,
  else from $JAVA_HOME/lib/security/cacerts.</div>
</td>
</tr>
<tr class="rowColor" id="i19">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#logCertExpiration(java.io.File,java.lang.String,long)">logCertExpiration</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;f,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
long&nbsp;expiresWithin)</code></th>
<td class="colLast">
<div class="block">Validate expiration for all private key certs in a key store.</div>
</td>
</tr>
<tr class="altColor" id="i20">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#logCertExpiration(java.security.KeyStore,java.lang.String,long)">logCertExpiration</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;location,
long&nbsp;expiresWithin)</code></th>
<td class="colLast">
<div class="block">Validate expiration for all private key certs in a key store.</div>
</td>
</tr>
<tr class="rowColor" id="i21">
<td class="colFirst"><code>static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#main(java.lang.String%5B%5D)">main</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;args)</code></th>
<td class="colLast">
<div class="block">Usage: KeyStoreUtil system (loads from system keystore)
          KeyStoreUtil foo.ks (loads from system keystore, and from foo.ks keystore if exists, else creates empty)
          KeyStoreUtil import file.ks file.key alias keypw (imports private key from file to keystore)
          KeyStoreUtil export file.ks alias keypw (exports private key from keystore)
          KeyStoreUtil keygen file.ks alias keypw (create keypair in keystore)
          KeyStoreUtil keygen2 file.ks alias keypw (create keypair using I2PProvider)</div>
</td>
</tr>
<tr class="altColor" id="i22">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#randomString()">randomString</a></span>()</code></th>
<td class="colLast">
<div class="block">48 char b32 string (30 bytes of entropy)</div>
</td>
</tr>
<tr class="rowColor" id="i23">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/security/cert/X509Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">X509Certificate</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#renewPrivateKeyCertificate(java.io.File,java.lang.String,java.lang.String,java.lang.String,int)">renewPrivateKeyCertificate</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW,
int&nbsp;validDays)</code></th>
<td class="colLast">
<div class="block">Renew the the private key certificate in a keystore.</div>
</td>
</tr>
<tr class="altColor" id="i24">
<td class="colFirst"><code>static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#storePrivateKey(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.security.PrivateKey,java.util.List)">storePrivateKey</a></span>&#8203;(<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/PrivateKey.html?is-external=true" title="class or interface in java.security" class="externalLink">PrivateKey</a>&nbsp;pk,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/security/cert/X509Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">X509Certificate</a>&gt;&nbsp;certs)</code></th>
<td class="colLast">
<div class="block">Import the private key and certificate chain to a keystore.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<a id="methods.inherited.from.class.java.lang.Object">
</a><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<li class="blockList">
<section class="fieldDetails"><a id="field.detail">
</a>
<h2>Field Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="DEFAULT_KEYSTORE_PASSWORD">DEFAULT_KEYSTORE_PASSWORD</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></span>&nbsp;<span class="memberName">DEFAULT_KEYSTORE_PASSWORD</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#net.i2p.crypto.KeyStoreUtil.DEFAULT_KEYSTORE_PASSWORD">Constant Field Values</a></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<li class="blockList">
<section class="constructorDetails"><a id="constructor.detail">
</a>
<h2>Constructor Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;()">KeyStoreUtil</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="memberName">KeyStoreUtil</span>()</div>
</section>
</li>
</ul>
</section>
</li>
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="createKeyStore(java.io.File,java.lang.String)">createKeyStore</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a></span>&nbsp;<span class="memberName">createKeyStore</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ksFile,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password)</span>
                               throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">Create a new KeyStore object, and load it from ksFile if it is
  non-null and it exists.
  If ksFile is non-null and it does not exist, create a new empty
  keystore file.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ksFile</code> - may be null</dd>
<dd><code>password</code> - may be null</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="loadSystemKeyStore()">loadSystemKeyStore</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a></span>&nbsp;<span class="memberName">loadSystemKeyStore</span>()</div>
<div class="block">Loads certs from location of javax.net.ssl.keyStore property,
  else from $JAVA_HOME/lib/security/jssecacerts,
  else from $JAVA_HOME/lib/security/cacerts.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>null on catastrophic failure, returns empty KeyStore if can't load system file</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8.2, moved from SSLEepGet.initSSLContext() in 0.9.9</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="countCerts(java.security.KeyStore)">countCerts</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">countCerts</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks)</span></div>
<div class="block">Count all X509 Certs in a key store</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>number successfully added</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8.2, moved from SSLEepGet in 0.9.9</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="logCertExpiration(java.io.File,java.lang.String,long)">logCertExpiration</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">logCertExpiration</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;f,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
long&nbsp;expiresWithin)</span></div>
<div class="block">Validate expiration for all private key certs in a key store.
  Use this for keystores containing selfsigned certs where the
  user will be expected to renew an expiring cert.
  Use this for Jetty keystores, where we aren't doing the loading ourselves.

  If a cert isn't valid, it will probably cause bigger problems later when it's used.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>f</code> - keystore file</dd>
<dd><code>ksPW</code> - keystore password</dd>
<dd><code>expiresWithin</code> - ms if cert expires within this long, we will log a warning, e.g. 180*24*60*60*1000L</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if all are good, false if we logged something</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.34</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="logCertExpiration(java.security.KeyStore,java.lang.String,long)">logCertExpiration</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">logCertExpiration</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;location,
long&nbsp;expiresWithin)</span></div>
<div class="block">Validate expiration for all private key certs in a key store.
  Use this for keystores containing selfsigned certs where the
  user will be expected to renew an expiring cert.
  Use this for keystores we are feeding to an SSLContext and ServerSocketFactory.

  We added support for self-signed certs in 0.8.3 2011-01, with a 10-year expiration.
  We still don't generate them by default. We don't expect anybody's
  certs to expire until 2021.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>location</code> - the path or other identifying info, for logging only</dd>
<dd><code>expiresWithin</code> - ms if cert expires within this long, we will log a warning, e.g. 180*24*60*60*1000L</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if all are good, false if we logged something</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.34</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addCerts(java.io.File,java.security.KeyStore)">addCerts</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">addCerts</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;dir,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks)</span></div>
<div class="block">Load all X509 Certs from a directory and add them to the
  trusted set of certificates in the key store

  This DOES check for revocation.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>number successfully added</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8.2, moved from SSLEepGet in 0.9.9</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addCert(java.io.File,java.lang.String,java.security.KeyStore)">addCert</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">addCert</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;file,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks)</span></div>
<div class="block">Load an X509 Cert from a file and add it to the
  trusted set of certificates in the key store

  This does NOT check for revocation.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8.2, moved from SSLEepGet in 0.9.9</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addCert(java.io.File,java.lang.String,java.security.KeyStore,java.security.cert.CertStore)">addCert</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">addCert</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;file,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html?is-external=true" title="class or interface in java.security" class="externalLink">KeyStore</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/cert/CertStore.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">CertStore</a>&nbsp;cs)</span></div>
<div class="block">Load an X509 Cert from a file and add it to the
  trusted set of certificates in the key store

  This DOES check for revocation, IF cs is non-null.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cs</code> - may be null; if non-null, check for revocation</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.25</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="randomString()">randomString</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></span>&nbsp;<span class="memberName">randomString</span>()</div>
<div class="block">48 char b32 string (30 bytes of entropy)</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createKeys(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.lang.String)">createKeys</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">createKeys</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</span></div>
<div class="block">Create a keypair and store it in the keystore at ks, creating it if necessary.
  Use default keystore password, valid days, algorithm, and key size.

  As of 0.9.35, default algorithm and size depends on cname. If it appears to be
  a CA, it will use EC/256. Otherwise, it will use RSA/2048.

  Warning, may take a long time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>cname</code> - e.g. localhost. Must be a hostname or email address. IP addresses will not be correctly encoded.</dd>
<dd><code>ou</code> - e.g. console</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8.3, consolidated from RouterConsoleRunner and SSLClientListenerRunner in 0.9.9</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createKeys(java.io.File,java.lang.String,java.lang.String,java.util.Set,java.lang.String,java.lang.String)">createKeys</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">createKeys</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;altNames,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</span></div>
<div class="block">Create a keypair and store it in the keystore at ks, creating it if necessary.
  Use default keystore password, valid days, algorithm, and key size.

  As of 0.9.35, default algorithm and size depends on cname. If it appears to be
  a CA, it will use EC/256. Otherwise, it will use RSA/2048.

  Warning, may take a long time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>cname</code> - e.g. localhost. Must be a hostname or email address. IP addresses will not be correctly encoded.</dd>
<dd><code>altNames</code> - the Subject Alternative Names. May be null. May contain hostnames and/or IP addresses.
                  cname, localhost, 127.0.0.1, and ::1 will be automatically added.</dd>
<dd><code>ou</code> - e.g. console</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.34 added altNames param</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createKeys(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.lang.String,int,java.lang.String,int,java.lang.String)">createKeys</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">createKeys</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyAlg,
int&nbsp;keySize,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</span></div>
<div class="block">Create a keypair and store it in the keystore at ks, creating it if necessary.

  For new code, the createKeysAndCRL() with the SigType argument is recommended over this one,
  as it throws exceptions, and returns the certificate and CRL.

  Warning, may take a long time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>cname</code> - e.g. localhost. Must be a hostname or email address. IP addresses will not be correctly encoded.</dd>
<dd><code>ou</code> - e.g. console</dd>
<dd><code>validDays</code> - e.g. 3652 (10 years)</dd>
<dd><code>keyAlg</code> - e.g. DSA , RSA, EC</dd>
<dd><code>keySize</code> - e.g. 1024</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8.3, consolidated from RouterConsoleRunner and SSLClientListenerRunner in 0.9.9</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createKeys(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.util.Set,java.lang.String,int,java.lang.String,int,java.lang.String)">createKeys</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">createKeys</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;altNames,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyAlg,
int&nbsp;keySize,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</span></div>
<div class="block">Create a keypair and store it in the keystore at ks, creating it if necessary.

  For new code, the createKeysAndCRL() with the SigType argument is recommended over this one,
  as it throws exceptions, and returns the certificate and CRL.

  Warning, may take a long time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>cname</code> - e.g. localhost. Must be a hostname or email address. IP addresses will not be correctly encoded.</dd>
<dd><code>altNames</code> - the Subject Alternative Names. May be null. May contain hostnames and/or IP addresses.
                  cname, localhost, 127.0.0.1, and ::1 will be automatically added.</dd>
<dd><code>ou</code> - e.g. console</dd>
<dd><code>validDays</code> - e.g. 3652 (10 years)</dd>
<dd><code>keyAlg</code> - e.g. DSA , RSA, EC</dd>
<dd><code>keySize</code> - e.g. 1024</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.34 added altNames param</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createKeysAndCRL(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.lang.String,int,java.lang.String,int,java.lang.String)">createKeysAndCRL</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>[]</span>&nbsp;<span class="memberName">createKeysAndCRL</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyAlg,
int&nbsp;keySize,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</span>
                                 throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">New way - Native Java, does not call out to keytool.
  Create a keypair and store it in the keystore at ks, creating it if necessary.

  This returns the public key, private key, certificate, and CRL in an array.
  All of these are Java classes. Keys may be converted to I2P classes with SigUtil.
  The private key and selfsigned cert are stored in the keystore.
  The public key may be derived from the private key with KeyGenerator.getSigningPublicKey().
  The public key certificate may be stored separately with
  CertUtil.saveCert() if desired.
  The CRL is not stored by this method, store it with
  CertUtil.saveCRL() or CertUtil.exportCRL() if desired.

  Throws on all errors.
  Warning, may take a long time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>cname</code> - e.g. localhost. Must be a hostname or email address. IP addresses will not be correctly encoded.</dd>
<dd><code>ou</code> - e.g. console</dd>
<dd><code>validDays</code> - e.g. 3652 (10 years)</dd>
<dd><code>keyAlg</code> - e.g. DSA , RSA, EC</dd>
<dd><code>keySize</code> - e.g. 1024</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>all you need:
      rv[0] is a Java PublicKey
      rv[1] is a Java PrivateKey
      rv[2] is a Java X509Certificate
      rv[3] is a Java X509CRL</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.25</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createKeysAndCRL(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.util.Set,java.lang.String,int,java.lang.String,int,java.lang.String)">createKeysAndCRL</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>[]</span>&nbsp;<span class="memberName">createKeysAndCRL</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;altNames,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyAlg,
int&nbsp;keySize,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</span>
                                 throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">New way - Native Java, does not call out to keytool.
  Create a keypair and store it in the keystore at ks, creating it if necessary.

  This returns the public key, private key, certificate, and CRL in an array.
  All of these are Java classes. Keys may be converted to I2P classes with SigUtil.
  The private key and selfsigned cert are stored in the keystore.
  The public key may be derived from the private key with KeyGenerator.getSigningPublicKey().
  The public key certificate may be stored separately with
  CertUtil.saveCert() if desired.
  The CRL is not stored by this method, store it with
  CertUtil.saveCRL() or CertUtil.exportCRL() if desired.

  Throws on all errors.
  Warning, may take a long time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>cname</code> - e.g. localhost. Must be a hostname or email address. IP addresses will not be correctly encoded.</dd>
<dd><code>altNames</code> - the Subject Alternative Names. May be null. May contain hostnames and/or IP addresses.
                  cname, localhost, 127.0.0.1, and ::1 will be automatically added.</dd>
<dd><code>ou</code> - e.g. console</dd>
<dd><code>validDays</code> - e.g. 3652 (10 years)</dd>
<dd><code>keyAlg</code> - e.g. DSA , RSA, EC</dd>
<dd><code>keySize</code> - e.g. 1024</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>all you need:
      rv[0] is a Java PublicKey
      rv[1] is a Java PrivateKey
      rv[2] is a Java X509Certificate
      rv[3] is a Java X509CRL</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.34 added altNames param</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createKeysAndCRL(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.lang.String,int,net.i2p.crypto.SigType,java.lang.String)">createKeysAndCRL</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>[]</span>&nbsp;<span class="memberName">createKeysAndCRL</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="SigType.html" title="enum in net.i2p.crypto">SigType</a>&nbsp;type,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</span>
                                 throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">New way - Native Java, does not call out to keytool.
  Create a keypair and store it in the keystore at ks, creating it if necessary.

  This returns the public key, private key, certificate, and CRL in an array.
  All of these are Java classes. Keys may be converted to I2P classes with SigUtil.
  The private key and selfsigned cert are stored in the keystore.
  The public key may be derived from the private key with KeyGenerator.getSigningPublicKey().
  The public key certificate may be stored separately with
  CertUtil.saveCert() if desired.
  The CRL is not stored by this method, store it with
  CertUtil.saveCRL() or CertUtil.exportCRL() if desired.

  Throws on all errors.
  Warning, may take a long time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>cname</code> - e.g. localhost. Must be a hostname or email address. IP addresses will not be correctly encoded.</dd>
<dd><code>ou</code> - e.g. console</dd>
<dd><code>validDays</code> - e.g. 3652 (10 years)</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>all you need:
      rv[0] is a Java PublicKey
      rv[1] is a Java PrivateKey
      rv[2] is a Java X509Certificate
      rv[3] is a Java X509CRL</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.25</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createKeysAndCRL(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.util.Set,java.lang.String,int,net.i2p.crypto.SigType,java.lang.String)">createKeysAndCRL</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>[]</span>&nbsp;<span class="memberName">createKeysAndCRL</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cname,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;altNames,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ou,
int&nbsp;validDays,
<a href="SigType.html" title="enum in net.i2p.crypto">SigType</a>&nbsp;type,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</span>
                                 throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">New way - Native Java, does not call out to keytool.
  Create a keypair and store it in the keystore at ks, creating it if necessary.

  This returns the public key, private key, certificate, and CRL in an array.
  All of these are Java classes. Keys may be converted to I2P classes with SigUtil.
  The private key and selfsigned cert are stored in the keystore.
  The public key may be derived from the private key with KeyGenerator.getSigningPublicKey().
  The public key certificate may be stored separately with
  CertUtil.saveCert() if desired.
  The CRL is not stored by this method, store it with
  CertUtil.saveCRL() or CertUtil.exportCRL() if desired.

  Throws on all errors.
  Warning, may take a long time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>cname</code> - e.g. localhost. Must be a hostname or email address. IP addresses will not be correctly encoded.</dd>
<dd><code>altNames</code> - the Subject Alternative Names. May be null. May contain hostnames and/or IP addresses.
                  cname, localhost, 127.0.0.1, and ::1 will be automatically added.</dd>
<dd><code>ou</code> - e.g. console</dd>
<dd><code>validDays</code> - e.g. 3652 (10 years)</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>all you need:
      rv[0] is a Java PublicKey
      rv[1] is a Java PrivateKey
      rv[2] is a Java X509Certificate
      rv[3] is a Java X509CRL</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.34 added altNames param</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getPrivateKey(java.io.File,java.lang.String,java.lang.String,java.lang.String)">getPrivateKey</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/PrivateKey.html?is-external=true" title="class or interface in java.security" class="externalLink">PrivateKey</a></span>&nbsp;<span class="memberName">getPrivateKey</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW)</span>
                                throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">Get a private key out of a keystore</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password, may be null</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the key or null if not found</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="exportPrivateKey(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.io.OutputStream)">exportPrivateKey</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">exportPrivateKey</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io" class="externalLink">OutputStream</a>&nbsp;out)</span>
                             throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">Export the private key and certificate chain (if any) out of a keystore.
  Does NOT close the output stream. Throws on all errors.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password, may be null</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.25</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="renewPrivateKeyCertificate(java.io.File,java.lang.String,java.lang.String,java.lang.String,int)">renewPrivateKeyCertificate</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/cert/X509Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">X509Certificate</a></span>&nbsp;<span class="memberName">renewPrivateKeyCertificate</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW,
int&nbsp;validDays)</span>
                                                  throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">Renew the the private key certificate in a keystore.
  Closes the input and output streams. Throws on all errors.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password, may be null</dd>
<dd><code>alias</code> - the name of the key, or null to get the first one in keystore</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dd><code>validDays</code> - new cert to expire this many days from now</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the new certificate</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.34</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="importPrivateKey(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.io.InputStream)">importPrivateKey</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></span>&nbsp;<span class="memberName">importPrivateKey</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html?is-external=true" title="class or interface in java.io" class="externalLink">InputStream</a>&nbsp;in)</span>
                               throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">Import the private key and certificate chain to a keystore.
  Keystore will be created if it does not exist.
  Private key MUST be first in the stream.
  Closes the stream. Throws on all errors.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password, may be null</dd>
<dd><code>alias</code> - the name of the key. If null, will be taken from the Subject CN
               of the first certificate in the chain.</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the alias as specified or extracted</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.25</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="storePrivateKey(java.io.File,java.lang.String,java.lang.String,java.lang.String,java.security.PrivateKey,java.util.List)">storePrivateKey</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">storePrivateKey</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;keyPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/security/PrivateKey.html?is-external=true" title="class or interface in java.security" class="externalLink">PrivateKey</a>&nbsp;pk,
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/security/cert/X509Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">X509Certificate</a>&gt;&nbsp;certs)</span>
                            throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">Import the private key and certificate chain to a keystore.
  Keystore will be created if it does not exist.
  Private key MUST be first in the stream.
  Closes the stream. Throws on all errors.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password, may be null</dd>
<dd><code>alias</code> - the name of the key, non-null.</dd>
<dd><code>keyPW</code> - the key password, must be at least 6 characters</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.25</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getCert(java.io.File,java.lang.String,java.lang.String)">getCert</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a></span>&nbsp;<span class="memberName">getCert</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias)</span>
                           throws <span class="exceptions"><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a>,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<div class="block">Get a cert out of a keystore</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password, may be null</dd>
<dd><code>alias</code> - the name of the key</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the certificate or null if not found</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="exportCert(java.io.File,java.lang.String,java.lang.String,java.io.File)">exportCert</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">exportCert</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;ks,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;ksPW,
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;alias,
<a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io" class="externalLink">File</a>&nbsp;certFile)</span></div>
<div class="block">Pull the cert back OUT of the keystore and save it in Base64-encoded X.509 format
  so the clients can get to it.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ks</code> - path to the keystore</dd>
<dd><code>ksPW</code> - the keystore password, may be null</dd>
<dd><code>alias</code> - the name of the key</dd>
<dd><code>certFile</code> - output</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>success</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8.3 moved from SSLClientListenerRunner in 0.9.9</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="main(java.lang.String[])">main</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">main</span>&#8203;(<span class="arguments"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;args)</span></div>
<div class="block">Usage: KeyStoreUtil system (loads from system keystore)
          KeyStoreUtil foo.ks (loads from system keystore, and from foo.ks keystore if exists, else creates empty)
          KeyStoreUtil import file.ks file.key alias keypw (imports private key from file to keystore)
          KeyStoreUtil export file.ks alias keypw (exports private key from keystore)
          KeyStoreUtil keygen file.ks alias keypw (create keypair in keystore)
          KeyStoreUtil keygen2 file.ks alias keypw (create keypair using I2PProvider)</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
</main>
<footer role="contentinfo">
<nav role="navigation">
<div class="bottomNav"><a id="navbar.bottom">
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/KeyStoreUtil.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
</a>
</nav>
</footer>
</div>
</div>
</body>
</html>
